## 1. General Principles & Philosophy
- **Эксперимент и R&D:** Проект является исследовательской платформой.
- **Open Source:** Лицензия MIT. Код должен быть чистым и понятным.
- **Итеративность:** Разработка ведется микро-шагами.
- **Нейрокодинг + Верификация:** Используем AI-ассистенты (Trae IDE с Gemini 2.5/Claude 3.x, GitHub Copilot) для генерации и модификации кода, но **весь AI-сгенерированный код должен быть тщательно проверен, протестирован и понят НейроКодером (человеком)** перед коммитом.
- **Ручной Контроль:** Приоритет всегда за решениями НейроКодера.
- **Чистый Код:** 
    - Соблюдение линтеров (ESLint, Prettier для JS; Flake8/Black для Python - *TODO: настроить и использовать*).
    - Модульность JavaScript (ES6 Modules).
    - Осмысленные имена переменных и функций.
    - Комментарии для нетривиального кода.
- **Документирование:** Поддержание актуальности Системной Инструкции, README, описаний Issues и GitHub Projects.
- **Адаптивный UI/UX:** Минимализм, отзывчивость (использование `clamp()`, Flexbox, Grid).
- **Безопасность:** Никогда не коммитить API ключи, токены, пароли или другие секреты в репозиторий. Использовать переменные окружения и `.env` (который в `.gitignore`).

## 2. Core Technologies & Stack
- **Backend:** Python 3.12, FastAPI, Uvicorn.
- **Frontend:** JavaScript (ES6 Modules), Three.js (r128), HTML5, CSS3.
- **База данных:** MongoDB Atlas (через Motor async driver).
- **AI (LLM):** LangChain, Mistral API (ChatMistralAI).
- **Мультимодальность (WIP):** Web Speech API, MediaPipe Hands.
- **Развертывание:** Hugging Face Spaces (Gradio SDK, Docker).
- **CI/CD:** GitHub Actions.
- **Контроль версий:** Git, GitHub.

## 3. Структура Проекта (Основные директории)
- `/app.py`: Основной файл бэкенда FastAPI.
- `/frontend/`: Все файлы фронтенда.
    - `/frontend/index.html`: Главный HTML-файл.
    - `/frontend/style.css`: Основные стили.
    - `/frontend/script.js`: Старый монолитный JS (в процессе рефакторинга).
    - `/frontend/js/`: Новая модульная структура JS.
        - `/frontend/js/main.js`: Основная точка входа для новых JS модулей.
        - `/frontend/js/core/`, `/frontend/js/audio/`, `/frontend/js/3d/`, `/frontend/js/gestures/`, `/frontend/js/ai/`, `/frontend/js/panels/`, `/frontend/js/utils/`
- `/requirements.txt`: Зависимости Python.
- `/Dockerfile`: Конфигурация Docker для HF Spaces.
- `/.github/workflows/`: Файлы GitHub Actions.

## 4. Правила Работы с Кодом
- **Коммиты:** Сообщения коммитов должны быть осмысленными, желательно следовать конвенции (например, `feat: ...`, `fix: ...`, `refactor: ...`, `chore: ...`).
- **Ветвление:** Для новых фич или сложных исправлений использовать отдельные ветки. `main` должна быть стабильной.
- **JavaScript:**
    - Использовать ES6+ синтаксис и модули.
    - Избегать глобальных переменных там, где это возможно.
    - Рефакторинг `script.js` в модули является приоритетом.
    - Пути к статике в HTML должны начинаться с `/static/`. Пути импорта внутри JS модулей (в `/frontend/js/`) должны быть, как правило, относительными.
- **Python (app.py):**
    - Следовать PEP 8 (после настройки линтера).
    - Использовать async/await для асинхронных операций (особенно с Motor и FastAPI).
    - Тщательно обрабатывать ошибки и логировать их.
- **API Ключи и Секреты:** Загружать из переменных окружения (`os.getenv()`). Файл `.env` для локальной разработки.

## 5. Взаимодействие с AI-Ассистентом (Trae IDE)
- **Промптинг:** Использовать четкие, детализированные микропромпты. Указывать контекст (`@file`, `@folder`, `#Project Rules`).
- **Ожидаемый Результат от AI:**
    1.  Краткое резюме выполненных шагов.
    2.  ТОЛЬКО ИЗМЕНЕННЫЕ ФРАГМЕНТЫ КОДА (с контекстом до/после, если возможно, в формате diff или "БЫЛО/СТАЛО единым блоком"). НЕ полный код файлов.
    3.  Результаты выполнения тестов или команд терминала, если были запрошены (ПОЛНЫЙ ВЫВОД).
    4.  Предложения по коммиту (сообщение коммита).
- **Тестирование:** AI может быть запрошен выполнить базовые тесты (например, запуск сервера, curl). НейроКодер проводит UI-тестирование и верификацию.
- **Коммиты и Push:** AI может предлагать команды `git add`, `git commit`. `git push` выполняется НейроКодером после проверки. **Если в промпте явно указано, AI ДОЛЖЕН выполнить `git add`, `git commit` и `git push` через терминал и предоставить их вывод.**

## 6. Текущие Приоритеты (на v26.0, для справки AI)
1.  **Стабилизация Фронтенда:** Устранение ошибок 404 для JS файлов (проверка путей в `index.html` и импортов в `main.js` и других модулях).
2.  **Активация LLM:** Раскомментировать и настроить инициализацию `ChatMistralAI` в `app.py`.
3.  **Подключение MongoDB:** Решить проблему аутентификации MongoDB Atlas (Issue #1).
4.  **Рефакторинг JS:** Продолжение переноса логики из `script.js` в модули.

## 7. Важно для AI при модификации кода:
- Не удаляй существующую функциональность, если это не указано явно.
- Если модуль или файл не найден, но на него есть ссылка, сначала уточни, должен ли он существовать или ссылку нужно удалить/закомментировать. НЕ УДАЛЯЙ ИМПОРТЫ важных модулей без явного указания.
- Придерживайся стиля существующего кода.