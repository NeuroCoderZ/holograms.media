Project Rules for Holograms Media (holograms.media) - v30.0
Дата: 24 мая 2025 г.
Версия проекта: ~0.2.x (стабилизация фронтенда, подготовка к CI/CD и задачам для Jules)
AI-ассистенты: Джемини (в Trae IDE), Клод (в Trae IDE), Jules (jules.google.com)
0. Актуальный Контекст Проекта (КРИТИЧЕСКИ ВАЖНО!)
Перед КАЖДОЙ задачей AI-агент (Джемини, Клод) ОБЯЗАН изучить актуальные версии следующих файлов в корне проекта (без символа "@" перед именем):
PROJECT_CONTEXT.md (текущее состояние, цели, проблемы, фокус)
tria_memory_buffer.md (детальный лог итераций, история решений)
Если эти файлы отсутствуют или очевидно устарели (например, дата в PROJECT_CONTEXT.md сильно отличается от текущей), AI должен первым делом предложить их создать или обновить, запросив необходимую информацию у НейроКодера.
Основные Документы-Ориентиры:
Системная Инструкция: Проект "Голографические Медиа" (v29.0++): Фундаментальный документ, описывающий общую концепцию, философию, долгосрочное видение и ключевые технологии.
ARCHITECTURE.md: Описание текущей и целевой архитектуры, потоков данных, взаимодействия компонентов, глоссарий.
MODULE_CATALOG.md: Детальный справочник frontend-модулей (назначение, зависимости, экспорты, статус).
ROADMAP.md: План развития проекта, ключевые этапы и задачи.
FUTUREARCHITECTURE.md: Долгосрочное видение архитектуры, "Неоленг", "HoloGraph".
AI должен ссылаться на эти документы при необходимости и следовать изложенным в них принципам.
1. Общие Принципы и Философия Разработки
R&D Платформа: Мы создаем инновационную исследовательскую и девелоперскую платформу для новой эры коммуникации через интерактивные 3D-аудиовизуализации ("голограммы") и AI "Триа".
Open Source (MIT License): Весь код должен быть чистым, хорошо документированным, модульным и следовать лучшим практикам.
Итеративность и Микро-шаги: Разработка ведется небольшими, осмысленными итерациями. Рефакторинг – непрерывный процесс улучшения.
Нейрокодинг и Валидация Человеком:
AI-ассистенты (Джемини, Клод в Trae IDE; Jules) являются мощными инструментами для генерации кода, анализа, рефакторинга и документирования.
НейроКодер (Александр) выступает в роли ведущего архитектора, стратега, постановщика задач и финального валидатора. Любой код, предложенный AI, должен быть тщательно проверен, протестирован и осмыслен НейроКодером перед коммитом и слиянием в основную ветку.
Комплексное Документирование: Все ключевые .md файлы (см. п.0) должны быть "живыми" документами, постоянно актуализируемыми. AI-агенты активно участвуют в их обновлении.
Безопасность: Никаких секретов (API ключи, пароли) в коде или репозитории. Использовать .env для локальной разработки и Secrets на платформах развертывания (GitHub Actions, Hugging Face Spaces).
2. Ключевые Технологии и Стек (Целевой)
Backend: Python 3.12+, FastAPI, Uvicorn (ASGI), PostgreSQL + pgvector (драйвер asyncpg). MongoDB – временно для /chat, подлежит миграции.
Frontend: JavaScript (ES6 Modules), Three.js (r128+), WebGPU (цель), WebGL (текущий), WebRTC, Web Audio API (с перспективой использования WebAssembly для вейвлет-преобразования), MediaPipe Hands, Web Speech API.
AI "Триа": Сеть специализированных ботов (GestureBot, AudioBot, MemoryBot, LearningBot, CoordinationService), LangChain, RAG-механизмы, генетические/эволюционные алгоритмы, принципы Absolute Zero Reasoning (AZR) для самообучения.
Развертывание: Hugging Face Spaces (с использованием Docker).
CI/CD: GitHub Actions (для линтинга, тестов (в будущем), и автоматического перезапуска HF Space при пуше на github/main – этот Action требует отладки).
Инструменты Качества Кода: ESLint, Prettier (для frontend), Flake8/Black (для backend – планируется).
Тестирование: Юнит-тесты (Pytest для backend, Jest/Vitest для frontend – планируется), E2E тесты (Playwright – планируется), ручное тестирование на HF Spaces.
3. Ключевые Файлы Проекта и Их Назначение (Обязательны для понимания AI)
.github/workflows/sync-to-hf.yml (или аналогичный): GitHub Action для автоматического перезапуска Hugging Face Space. (Требует отладки!)
backend/app.py: Основной файл FastAPI бэкенд-приложения.
backend/tria_bots/: Директория для модулей AI-ботов "Триа".
frontend/index.html: Единственная HTML-страница SPA.
frontend/js/main.js: Главная точка входа для JavaScript фронтенда, оркестратор модулей.
frontend/js/core/init.js: Инициализация глобального объекта state.
frontend/script.js.bak: Резервная копия старого монолитного скрипта. Используется как ИСТОЧНИК ЛОГИКИ при рефакторинге и переносе функциональности в модули. AI должен часто сверяться с ним.
Корневые .md файлы: PROJECT_CONTEXT.md, tria_memory_buffer.md, ARCHITECTURE.md, MODULE_CATALOG.md, ROADMAP.md, FUTUREARCHITECTURE.md.
4. Правила Работы с Кодом
Коммиты: Следовать стилю Conventional Commits (например, fix(frontend): resolve issue X, feat(backend): add Y endpoint, docs: update Z). Сообщения коммитов на английском.
JavaScript (ES6+ Modules): Строгая модульность, import/export. Избегать глобальных переменных вне state объекта. Следовать лучшим практикам.
Python (Backend): Асинхронность (async/await) где это целесообразно (особенно для FastAPI и работы с БД). PEP 8. Типизация (type hints).
HTML/CSS: Валидный, семантичный HTML5. Современный CSS (Flexbox, Grid, Custom Properties), БЭМ-подобная методология для именования классов (если применимо).
Тестирование (в процессе внедрения):
Фронтенд: Логи консоли F12, diagnostics.js. Планируется Jest/Vitest.
Бэкенд: Планируется Pytest.
Линтеры:
JS: npx eslint frontend/js/ --fix
JS Форматирование: npx prettier --write "frontend/**/*.{js,html,css,md}"
Python: (Будет настроен Flake8/Black).
5. Взаимодействие с AI-Ассистентами (Джемини, Клод в Trae IDE)
Промптинг: Строго по Универсальному Шаблону Промпта v4.0+ (предоставляется НейроКодером). Контекст всегда включает @workspace, #Project Rules (этот документ), PROJECT_CONTEXT.md, tria_memory_buffer.md.
Ожидаемый Отчет от AI (Джемини, Клод):
Подтверждение ознакомления с PROJECT_CONTEXT.md и tria_memory_buffer.md.
Статус выполнения задачи (полностью/частично, какие пункты).
Изменения в коде: Формат "БЫЛО / СТАЛО" с достаточным контекстом (5-15 строк). Для новых файлов – полный код.
Объяснение логики ключевых изменений и принятых решений.
Вывод терминальных команд (если были, например, Git, ESLint).
Автоматическое обновление контекстных файлов:
tria_memory_buffer.md: Запись в формате: [ГГГГ-ММ-ДД ЧЧ:ММ] PROMPT_ID: X. ЦЕЛЬ: Y. РЕЗУЛЬТАТ: Z. ИЗМЕНЕННЫЕ_ФАЙЛЫ: A, B. СЛЕДУЮЩИЙ_ШАГ: W.
PROJECT_CONTEXT.md: Обновить разделы "Текущий Фокус", "Последние Изменения", "Критические Проблемы".
Другие .md файлы (ROADMAP.md, ARCHITECTURE.md и т.д.): Если была задача по их обновлению, предоставить измененный текст или diff.
Размер измененных файлов (если это релевантно, например, для script.js – 0 строк).
Возникшие проблемы/ограничения/предложения.
Git (через GitHub MCP / Terminal в Trae IDE – АВТОМАТИЧЕСКИ):
AI-агент ОБЯЗАН САМ выполнять Git-команды, если они указаны в секции "ЗАДАЧА НА GIT".
Стандартная последовательность (если не указано иное):
git add . (или конкретные файлы)
git commit -m "Сообщение из промпта"
git pull github main (для синхронизации перед пушем на основной GitHub)
git push github main
git push huggingface main --force (ПОКА GitHub Action не починен на 100%)
Предоставлять полный вывод всех Git-команд.
6. Взаимодействие с AI-Агентом Jules (jules.google.com)
Постановка Задач: НейроКодер ставит задачи Jules через ее веб-интерфейс или GitHub Issues (когда будет доступно).
Язык Промптов для Jules: По умолчанию английский, если не указано иное. Промпты должны быть максимально детализированными и учитывать ее специфику (работа с полным репозиторием, создание PR).
Интеграция Работы Jules: Изменения от Jules приходят в виде Pull Request'ов на GitHub. НейроКодер отвечает за их ревью, разрешение конфликтов (при необходимости, с помощью AI-ассистентов в Trae) и слияние в main.
7. Текущие Приоритеты Проекта (Всегда сверяться с актуальным PROJECT_CONTEXT.md!)
Приоритет 0 (ЗАВЕРШАЕТСЯ): Полная стабилизация фронтенда (устранение всех JS ошибок загрузки и базовых runtime ошибок).
Приоритет 1: Рефакторинг UI-логики (на основе анализа Jules и script.js.bak).
Приоритет 2: Отладка и обеспечение стабильной работы GitHub Action для автоматического деплоя на Hugging Face Spaces.
Приоритет 3: Документирование (MODULE_CATALOG.md, ARCHITECTURE.md, ROADMAP.md).
Приоритет 4: Начало работ по Backend (PostgreSQL) и AI "Триа".
8. Важные Принципы для AI при Модификации Кода
Не навреди: Стабильность превыше всего. Любые изменения не должны ломать существующую (пусть и неполную) функциональность без явного указания.
Атомарность изменений (где возможно): Старайся, чтобы один коммит решал одну логическую задачу или исправлял один баг.
Сверка с script.js.bak: При рефакторинге фронтенда и переносе логики, регулярно сверяйся с script.js.bak, чтобы не упустить важные детали работавшей ранее системы.
Контекст прежде всего: Если инструкция в промпте кажется устаревшей или противоречит актуальному состоянию проекта (описанному в PROJECT_CONTEXT.md или выявленному тобой), уточни у НейроКодера или предложи скорректированный план действий.
Глобальная Цель: Создать устойчивую, модульную, инновационную и хорошо документированную платформу "Голографические Медиа", способную к эволюции и реализации долгосрочного видения проекта.