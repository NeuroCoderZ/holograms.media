Системная Инструкция: Проект "Голографические Медиа" (holograms.media) – Версия 34.0
Дата: 09.07.2024

A. Общая Шапка Документа
(Версия и дата обновлены выше)

B. Финальный Вектор Развития
- **Основной концептуальный документ:** docs/02_RESEARCH/WHITEGHOST.md, описывающий "Технологию Трехмерной Аудиовизуализации", жестовую ОС и принципы AI "Триа".
- **Базовый концептуальный документ**: `docs/00_OVERVIEW_AND_CONTEXT/CONCEPT_AND_PHILOSOPHY.md` является первоисточником концепции и философии проекта.
- **Инфраструктура Бэкенда**:
    - **Вычисления**: **Koyeb (Hobby Plan, Frankfurt)** для хостинга **FastAPI** приложения.
    - **База данных**: **Neon.tech (Free Tier)** для **PostgreSQL**.
    - **Хранилище файлов**: **Backblaze B2 (Free Tier)** как **S3-совместимое хранилище**.
- **Инфраструктура Фронтенда и Управления**:
    - **Хостинг**: Firebase Hosting.
    - **Аутентификация**: Firebase Authentication.
    - **DNS и Защита**: **Cloudflare** (включая Registrar, CDN, защита от DDoS, Bot Fight Mode, управление DNS).
- **CI/CD**: Деплой фронтенда на Firebase Hosting полностью автоматизирован через **GitHub Actions** (файл `.github/workflows/firebase-deploy.yml`).
- **Ядро Аудиоанализа**: Кастомный, высокопроизводительный **CWT-анализатор на Rust, скомпилированный в WebAssembly (WASM) и работающий через AudioWorklet**. (Стандартный FFT-анализ НЕ используется).
- Обучение ИИ-ассистента "Триа" на "комбинированных аудиовизуально-жестовых фрагментах" (чанках), обрабатываемых через бэкенд на Koyeb.
- Разработка интуитивных жестовых интерфейсов (включая поддержку русского жестового языка – РЖЯ – R&D, базовая интеграция MediaPipe Hands для текущего этапа).
- Создание самообучающейся сети ботов "Триа" (концепции AZR, "жидкий код" – долгосрочно, текущий этап фокусируется на простой логике Триа на FastAPI, размещенном на Koyeb).
- **R&D (Исследования и Разработки)**:
    - Интеграция подхода NVIDIA к преодолению разрыва между симуляцией и реальностью (sim-to-real gap).
    - Использование Genkit как целевого фреймворка для оркестрации AI-логики Триа и взаимодействия с моделями Google AI (например, Gemini).
    - Интеграция NLWeb как перспективной технологии для связи Триа с веб-ресурсами с целью извлечения знаний.
    - Внедрение децентрализованной экономической системы "HoloGraph".
- **Основной фокус**: Использование бесплатных или очень экономичных тиров для текущей реализации на всех указанных сервисах.

C. Версия проекта (ориентировочная): ~0.8.x (Production-ready core). (Статус обновлен: Цель MVP по созданию работающего цикла была сложной, но в целом достигнута).
Новый фокус: "Стабилизация ядра ТТА, восстановление утраченного UI/UX, интеграция с бэкендом на Koyeb".

Репозиторий: https://github.com/NeuroCoderZ/holograms.media

D. Развертывание:
-   **Frontend**: Firebase Hosting (управляется через GitHub Actions).
-   **Backend**: Koyeb (FastAPI).
-   **Database**: Neon.tech.
-   **File Storage**: Backblaze B2.
-   **DNS & Security**: Cloudflare.

Ключевые Документы Контекста:
- `docs/02_RESEARCH/WHITEGHOST.md` (Технология Трехмерной Аудиовизуализации, жестовая ОС, AI "Триа")
- `docs/00_OVERVIEW_AND_CONTEXT/CONCEPT_AND_PHILOSOPHY.md` (Концепция и философия проекта – первоисточник)
- `docs/00_OVERVIEW_AND_CONTEXT/PROJECT_CONTEXT.md` (Общее состояние, цели)
- `docs/05_PLANNING_AND_TASKS/ULTIMATE_ROAD_TO_MVP_JUNE_9.md` (Текущий операционный план)
- `docs/01_ARCHITECTURE/SYSTEM_ARCHITECTURE.md` (Архитектура потоков данных и взаимодействия)
- `docs/01_ARCHITECTURE/MODULE_CATALOG.md` (Каталог модулей фронтенда)
- `docs/02_RESEARCH/TRIA_CONCEPT.md` (Концепция Триа, "медленное обучение", AZR и взаимодействие ботов)
- `docs/02_RESEARCH/DEEP_RESEARCH_SYSTEM_BLUEPRINT_RU.md` (DRSB, долгосрочное видение, включая концепции FUTUREARCHITECTURE)
- `docs/00_OVERVIEW_AND_CONTEXT/ROADMAP.md` (Дорожная карта)
- `docs/04_REPORTS_AND_LOGS/generated_prompts.md` (Сгенерированные промпты для AI, включая "пакетные промпты")
(Эти документы регулярно актуализируются агентом NeuroCoderZ и AI-ассистентами).

E. ПРЕАМБУЛА: МАНИФЕСТ ПРОЕКТА "ГОЛОГРАФИЧЕСКИЕ МЕДИА"
Мы стоим на пороге новой эры коммуникации, создавая платформу holograms.media. Наша текущая реализация опирается на **гибридную, тщательно подобранную и экономичную облачную архитектуру, включающую Koyeb для FastAPI бэкенда, Neon.tech для PostgreSQL базы данных, Backblaze B2 для S3-совместимого хранения файлов, Firebase для хостинга фронтенда и аутентификации, а также Cloudflare для DNS, CDN и всесторонней защиты.** Этот стек позволяет нам эффективно развивать проект, используя преимущественно бесплатные или низкозатратные тиры сервисов.

Центральной фигурой этой экосистемы является AI-ассистент "Триа". Триа задумана как самообучающаяся жестовая лингвистическая модель, развивающаяся через принципы "медленного обучения". Важнейшим компонентом нашего подхода является **высокоточное ядро ТТА (Text-to-Audio/Animation), основанное на кастомном CWT-анализаторе (Continuous Wavelet Transform) на Rust, скомпилированном в WebAssembly (WASM) и работающем через AudioWorklet.** Это обеспечивает глубокий и производительный анализ аудиоданных непосредственно на клиенте. На текущем этапе основа Триа реализована как FastAPI приложение на Koyeb, обрабатывающее "комбинированные аудиовизуально-жестовые чанки" и предоставляющее базовые ответы, закладывая фундамент для будущей эволюции.

Мы верим в силу открытого исходного кода (лицензия MIT) и совместной работы сообщества для воплощения нашего видения интерактивных голографических медиа.

I. Введение: Обзор, Цели и Философия Проекта
1.1. Общая Концепция
Проект "Голографические Медиа" (holograms.media) — это амбициозная исследовательская и девелоперская инициатива... Платформа реализуется с использованием следующего стека, ориентированного на доступность и бесплатные тиры:
-   **Бэкенд**: **FastAPI приложение на Python (3.11+), развернутое на Koyeb (Hobby Plan, Frankfurt) через GitHub (потенциально с использованием Docker).**
-   **База данных**: **Neon.tech PostgreSQL + pgvector**, доступная из Koyeb, для хранения пользовательских данных, метаданных чанков и векторных эмбеддингов.
-   **Файловое хранилище**: **Backblaze B2** (S3-совместимое), доступ через API (например, `boto3`) из Koyeb, для хранения "чанков".
-   **Фронтенд**: Статическое веб-приложение на **Firebase Hosting**, обеспечивающее пользовательский интерфейс.
-   **Аутентификация**: **Firebase Authentication** для управления пользователями.
-   **DNS и Защита**: **Cloudflare** (для управления DNS, CDN, защиты от DDoS).
-   **AI "Триа" (текущий этап)**: Основа Триа, как **самообучающейся жестовой лингвистической модели** с принципами "медленного обучения" и AZR, реализуется через логику на **FastAPI эндпоинтах на Koyeb**. Эта логика использует API ключи для доступа к LLM (например, Mistral) и включает внутреннюю сеть специализированных ботов (см. `backend/tria_bots/`: `GestureBot`, `MemoryBot`, `LearningBot` с компонентами AZR - `TaskGenerator`, `TaskSolver`, `azr_evaluator`), оркестрируемых `CoordinationService`. Данные обрабатываются и хранятся с использованием **Neon.tech PostgreSQL** и **Backblaze B2**. Поддерживающие сервисы (`NLPService` и др. в `backend/services/`) также способствуют расширению возможностей Триа.

Ключевая идея проекта – преодоление симуляционно-реального разрыва в обучении AI "Триа"...

Технологическая основа проекта (текущий стек и долгосрочные цели, с сохранением деталей из v30.0++):
...
**Бэкенд-технологии**: **FastAPI на Koyeb (Python 3.11+, Hobby Plan, Frankfurt).**
**База данных**: **Neon.tech PostgreSQL + pgvector.** Подключение через `asyncpg` или `psycopg2` из FastAPI.
...
**Развертывание**: Frontend на Firebase Hosting, Backend на **Koyeb (Hobby Plan, Frankfurt)**, База Данных (**Neon.tech**), Хранилище (**Backblaze B2**), Аутентификация (Firebase Authentication), **DNS и Защита (Cloudflare)**.
...

1.2. Ключевые Направления Разработки (Стратегические и Тактические – Актуализировано, с сохранением R&D деталей из v30.0++)
A. ФРОНТЕНД: ... (взаимодействие с бэкендом на Koyeb)
... (загрузка чанков **через бэкенд на Koyeb в Backblaze B2**, базовое управление, чат с Триа **через FastAPI эндпоинты на Koyeb**).
...

B. БЭКЕНД: РЕАЛИЗАЦИЯ ТЕКУЩЕЙ ЛОГИКИ НА **KOYEB (FASTAPI)** (Высший приоритет)

Основной фокус: Реализация всей бэкенд-логики для текущего этапа в виде **FastAPI приложения на Python, развернутого на Koyeb (Hobby Plan, Frankfurt) через интеграцию с GitHub (возможно, с использованием Dockerfile для сборки)**, как детализировано в `ULTIMATE_ROAD_TO_MVP_JUNE_9.md`.
Ключевые задачи:
Настройка и интеграция с Firebase Authentication для защиты **FastAPI эндпоинтов** (проверка JWT токенов).
Взаимодействие с **Neon.tech PostgreSQL** ...
Работа с **Backblaze B2** (через `boto3` ...) для загрузки и управления "чанками" данных.
Прямые вызовы Mistral/Devstral или Google Gemini API из **FastAPI эндпоинтов на Koyeb** для базовой логики AI "Триа"...
Обеспечение корректной обработки запросов от фронтенда...

C. МУЛЬТИМОДАЛЬНОСТЬ И R&D: **Ядро Аудиоанализа CWT на Rust/WASM через AudioWorklet**. ... (остальное без изменений)
D. ДЕЦЕНТРАЛИЗАЦИЯ, "HOLOGRAPH" И ПРОТОКОЛ NETHOLOGLYPH ... (без изменений)

1.3. Ключевые Термины и Технологии (Расширенный Список, адаптировано)

Категория	Технологии/Концепции
...
Бэкенд	Python (3.11+), **FastAPI**, **Koyeb (Hobby Plan, Frankfurt)**, `asyncpg` / `psycopg2-binary` (для PostgreSQL), `SQLAlchemy` (опционально), **`boto3` (для Backblaze B2)**
Аудио Анализ	**CWT на Rust/WASM через AudioWorklet**
...
Развертывание / Deployment	**Koyeb (Backend, Hobby Plan, Frankfurt)**, Firebase Hosting (Frontend), **Backblaze B2 (Storage)**, **GitHub Actions (CI/CD для фронтенда)**, **Cloudflare (DNS, CDN, Security)**
Инструменты Разработки	Firebase Studio (Project IDX – основная среда), GitHub Copilot Chat (вспомогательный), Trae IDE (для специфических задач), Git, GitHub, GitHub Copilot Agent Mode (резерв), **Docker (для сборки и развертывания на Koyeb)**, Firebase Local Emulator Suite (для фронтенда, аутентификации), **Rust, cargo, wasm-pack**.
...

1.4. Философия и Принципы Разработки (Адаптировано к Koyeb/Backblaze B2/Neon и AI взаимодействию, с сохранением деталей из v30.0++)
... особенно в области мультимодального AI и его интеграции с выбранным стеком облачных сервисов (**Koyeb, Backblaze B2, Neon.tech, Firebase, Cloudflare**).
...
Приоритет Ручного Контроля и Глубокого Понимания: ... включая конфигурацию и взаимодействие сервисов **Koyeb, Backblaze B2, Neon.tech, Firebase и Cloudflare**. При возникновении сложных проблем... приоритет отдается ручной отладке, анализу логов (например, из **Koyeb**) и ручным исправлениям.
Бескомпромиссное Качество и Чистота Кода (Адаптировано для FastAPI на Koyeb):
... Для бэкенда – разработка **модульного FastAPI приложения, развертываемого на Koyeb (возможно, через Docker)**...
Глубокое и Актуальное Документирование: ... Особое внимание уделяется документированию конфигураций **FastAPI, Koyeb, Backblaze B2, Neon.tech, Cloudflare** и логики бэкенд-сервисов. Все AI-ассистенты должны рассматривать официальную документацию, начиная с `CONCEPT_AND_PHILOSOPHY.md`, как первоисточник для понимания задач и архитектуры.
Безопасность и Приватность (**Koyeb/Backblaze B2/Neon/Cloudflare-ориентированный подход**): ... Переменные окружения на **Koyeb** для управления API-ключами...
Среда Разработки и Развертывания (**Текущий Стек**):
... Локальный запуск FastAPI для тестирования бэкенда.
Развертывание: Frontend развертывается на Firebase Hosting. Бэкенд реализован как **FastAPI приложение на Koyeb (Hobby Plan, Frankfurt)**. База данных – **Neon.tech PostgreSQL**. **Backblaze B2** используется для хранения медиа-чанков. **Cloudflare** управляет DNS и обеспечивает безопасность.
...

**1.4.1. Взаимодействие с AI-ассистентами (Jules, "Flash", NeuroCoder) и Управление Проектом**
(Сохраняется существующий текст из v32.0++).

1.5. Концепция Осей Голограммы (Детализированная, с учетом вейвлетов и психоакустики)
(Сохраняется существующий текст из v32.0++).

1.6. Долгосрочные Видение и Цели (Манифест Будущего – Текущий стек как основа)
Текущая реализация, построенная на **Koyeb, Backblaze B2, Neon.tech и Firebase**, является первым шагом к реализации нашего долгосрочного видения.
...
AI-Ассистент "Триа" – Эволюционирующий Партнер: Развитие Триа от текущей реализации на **FastAPI (на Koyeb)** к полноценной самообучающейся сети ботов...

II. Архитектура и Текущее Состояние

2.1. Обзор Архитектуры
Наша архитектура построена на четком разделении фронтенда и бэкенда, с использованием современных и экономически эффективных облачных сервисов. Мы отказались от концепции "трех столпов" в ее прежнем виде, интегрировав ее принципы в более гибкую сервис-ориентированную модель.

2.2. Архитектура Фронтенда (Firebase Hosting + Чистый JS)
Фронтенд, размещенный на Firebase Hosting, написан на чистом JavaScript с модульной, платформо-специфичной архитектурой.
-   **Оркестратор**: `main.js` выступает в роли главного оркестратора, инициализируя и координируя работу всех модулей.
-   **Платформенные Менеджеры**: Логика, специфичная для различных платформ (desktop, mobile, XR), инкапсулирована в менеджерах внутри директории `/platforms`. Это позволяет адаптировать пользовательский опыт под конкретное устройство.
-   **Dependency Injection (DI)**: Используется принцип явной передачи состояния (state) и зависимостей между модулями и менеджерами, что обеспечивает прозрачность и тестируемость.
-   **Событийная Модель**: Взаимодействие между различными компонентами фронтенда построено на событийной модели, реализуемой через `EventBus`. Это позволяет модулям обмениваться информацией и реагировать на события, не создавая жестких связей.

2.3. Архитектура Бэкенда (Koyeb + FastAPI + Neon.tech + Backblaze B2)
Бэкенд-система реализована как FastAPI приложение, работающее на платформе Koyeb.
-   **FastAPI на Koyeb**: Основное приложение на FastAPI обрабатывает все API-запросы от фронтенда. Его ключевые роли:
    -   Аутентификация и авторизация запросов (интеграция с Firebase Authentication).
    -   Обработка бизнес-логики, включая логику AI "Триа".
    -   Проксирование запросов к Backblaze B2 для безопасной загрузки и скачивания файлов.
    -   Взаимодействие с базой данных Neon.tech для операций CRUD.
-   **Neon.tech (PostgreSQL)**: Используется как основная база данных для хранения структурированной информации: пользовательские данные, метаданные "чанков", состояния AI, логи и другие реляционные данные.
-   **Backblaze B2 (S3-совместимое хранилище)**: Применяется для хранения всех бинарных данных ("чанков"), таких как аудио- и видеофайлы, данные жестов и другие медиа-ассеты. Доступ к файлам осуществляется через API, как правило, через бэкенд на Koyeb.

2.4. Поток Данных (Frontend -> Koyeb -> B2/Neon.tech)
Типичный поток данных в системе выглядит следующим образом:
1.  **Клиент (Фронтенд)**: Пользователь инициирует действие (например, загрузка файла, отправка сообщения в чат Триа) через интерфейс на Firebase Hosting.
2.  **Запрос к Бэкенду**: Фронтенд отправляет аутентифицированный HTTPS запрос на соответствующий эндпоинт FastAPI приложения, работающего на Koyeb.
3.  **Обработка на Бэкенде (Koyeb/FastAPI)**:
    -   FastAPI принимает запрос, валидирует его и выполняет необходимую бизнес-логику.
    -   Если запрос включает файловые операции (например, загрузка "чанка"), FastAPI взаимодействует с Backblaze B2 для сохранения или получения файла. Для этого могут использоваться предварительно подписанные URL (presigned URLs) или прямое проксирование.
    -   Если запрос требует работы с данными (например, сохранение метаданных чанка, обновление профиля пользователя, запись лога взаимодействия), FastAPI обращается к базе данных Neon.tech PostgreSQL.
4.  **Ответ Клиенту**: FastAPI возвращает ответ фронтенду, который обновляет UI для пользователя.

2.5. Ядро Аудиоанализа (CWT на Rust/WASM)
Ключевым элементом обработки аудио на клиенте является наше кастомное ядро аудиоанализа.
-   **Технология**: Мы НЕ используем стандартный FFT-анализ. Вместо этого применяется высокопроизводительный **CWT-анализатор (Continuous Wavelet Transform), написанный на Rust и скомпилированный в WebAssembly (WASM).**
-   **Интеграция**: WASM-модуль работает через **AudioWorklet**, что позволяет производить сложный анализ аудиопотока в реальном времени без блокировки основного потока JavaScript, обеспечивая высокую производительность и точность.

2.6. CI/CD и Управление Инфраструктурой
-   **CI/CD**: Деплой фронтенда на Firebase Hosting полностью автоматизирован через **GitHub Actions** (файл `.github/workflows/firebase-deploy.yml`). Бэкенд на Koyeb также может быть настроен на автоматическое развертывание из GitHub.
-   **DNS и Защита**: **Cloudflare** управляет нашими DNS-записями и обеспечивает CDN, защиту от DDoS, Bot Fight Mode и другие меры безопасности.

III. Ключевые Проблемы и Задачи (Focus на текущем стеке Koyeb/R2/Neon)
3.1. Общая Стратегия Решения Проблем
... используя **текущий стек: Koyeb для бэкенда, Backblaze B2 для хранения, Neon.tech для БД и Firebase для фронтенда/аутентификации, Cloudflare для DNS и защиты**.

3.2. Основные Технические Вызовы и Задачи (Новый Фокус)
С учетом достижения основных целей MVP и перехода к стабилизации и расширению, старые проблемы в значительной степени решены. Текущие ключевые вызовы и задачи включают:

-   **Стабилизация и оптимизация WASM-модуля CWT**:
    -   Задача: Обеспечение стабильной работы и максимальной производительности кастомного CWT-анализатора на Rust/WASM на различных устройствах и браузерах.
    -   Вызовы: Профилирование производительности, оптимизация использования памяти в AudioWorklet, тестирование на широком спектке клиентских устройств, обеспечение плавной интеграции с аудиоконтекстом.

-   **Восстановление утраченного UI/UX на основе `restoration_plan`**:
    -   Задача: Планомерное восстановление и улучшение пользовательского интерфейса и опыта взаимодействия согласно документам в `docs/restoration_plan/`.
    -   Вызовы: Интерпретация и реализация планов восстановления, адаптация под текущую архитектуру фронтенда, обеспечение консистентности и интуитивности интерфейсов.

-   **Налаживание полной end-to-end связи Frontend (Firebase) ↔ Backend (Koyeb)**:
    -   Задача: Обеспечение надежного и безопасного взаимодействия между всеми компонентами фронтенда (на Firebase Hosting) и бэкенда (FastAPI на Koyeb), включая все API-эндпоинты, передачу данных и обработку состояний.
    -   Вызовы: Отладка интеграционных проблем, обеспечение корректной обработки аутентификационных токенов, управление CORS, оптимизация задержек в сети.

-   **Использование возможностей Cloudflare (CDN, кэширование, безопасность)**:
    -   Задача: Максимально эффективное использование предоставляемых Cloudflare сервисов для повышения производительности, безопасности и надежности приложения.
    -   Вызовы: Конфигурация правил кэширования для статики и API, настройка CDN, использование функций безопасности (WAF, Bot Fight Mode), мониторинг и анализ трафика через Cloudflare.

-   **Интеграция и Тестирование Бэкенд Сервисов (Koyeb, Neon.tech, Backblaze B2)**:
    -   Задача: Обеспечение бесперебойной и корректной работы связки FastAPI (Koyeb) с базой данных (Neon.tech) и файловым хранилищем (Backblaze B2).
    -   Вызовы: Управление миграциями схемы БД, обеспечение консистентности данных, обработка ошибок при взаимодействии с внешними сервисами, написание интеграционных тестов.

3.3. Приоритеты в Разработке
2.  Загрузка и сохранение "чанков" (**Backblaze B2** + **FastAPI на Koyeb** + Neon.tech).
(Остальное без изменений)

IV. План Развития AI "Триа" (Основан на WHITEGHOST.md)

4.1. Общая Философия и Цели (по WHITEGHOST.md)
Развитие AI "Триа" следует философии, изложенной в `docs/02_RESEARCH/WHITEGHOST.md`, где ключевым принципом является "Триа собирает себя сама". Это означает, что Триа должна непрерывно обучаться и эволюционировать на основе взаимодействий с пользователями и анализа окружающего контекста. Основой для этого служат "комбинированные аудиовизуально-жестовые фрагменты" ("чанки"), которые Триа обрабатывает, используя концепции, такие как Динамическая Семантическая Типизация для глубокого понимания данных и, в перспективе, "жидкий код" для адаптации собственной логики. **Текущая реализация на FastAPI (Koyeb) с хранением данных в Backblaze B2 (бинарные данные "чанков") и Neon.tech (метаданные и структурированные логи) является фундаментом для этого эволюционного процесса.**

4.2. Фаза 1: Создание Каркаса Ботов и Сбор Данных для "Медленного Обучения"
Первый этап направлен на создание основной инфраструктуры для ботов Триа, организацию процесса сбора "чанков" и внедрение системы логирования, необходимой для будущего "медленного обучения".

-   **Разработка и Интеграция Базовых Ботов (Каркас):**
    -   `GestureBot`: Начальная реализация для приема, структурирования и сохранения данных жестов (например, от MediaPipe или аналогичных источников) как части "чанков". Основной фокус – корректное формирование данных для последующего анализа.
    -   `AudioBot`: Базовая реализация для приема аудиопотоков и их структурирования в "чанках". Включает сохранение аудиоданных и их метаописаний.
    -   `MemoryBot`: Начальная реализация, отвечающая за взаимодействие с **Neon.tech** для сохранения/извлечения метаданных "чанков" и другой структурированной информации, а также за связь с файлами "чанков" в **Backblaze B2**.
    -   `LearningBot`: Создание базовой структуры и интерфейсов класса `LearningBot` и его компонентов (`TaskGenerator`, `TaskSolver`, `azr_evaluator`), которые на данном этапе будут выполнять минимальные функции или служить заглушками для будущей логики "медленного обучения" и AZR.
    -   `CoordinationService`: Обеспечение маршрутизации запросов и базового взаимодействия между вышеуказанными ботами в рамках текущей архитектуры на **FastAPI (Koyeb)**.

-   **Настройка Сбора "Чанков":**
    -   Формализация структуры "чанка" на основе концепций из `docs/02_RESEARCH/WHITEGHOST.md`: каждый "чанк" должен включать необработанные данные (raw data), первичные семантические дескрипторы (если применимо), контекст взаимодействия и, по возможности, обратную связь от пользователя.
    -   Реализация API-эндпоинтов на **FastAPI (размещенном на Koyeb)** для приема мультимодальных "чанков" от клиентских приложений.
    -   Организация процесса сохранения "чанков": бинарные медиа-файлы (аудио, видео, данные сенсоров) сохраняются в **Backblaze B2**; структурированные метаданные, семантические дескрипторы и контекстная информация – в базу данных **Neon.tech**.

-   **Реализация Базового Логирования для "Медленного Обучения":**
    -   Внедрение системы логирования, фиксирующей ключевые аспекты взаимодействий пользователя с Триа: входящие запросы, действия ботов, сгенерированные ответы, и, если возможно, неявную обратную связь (например, длительность взаимодействия, последующие запросы).
    -   Сохранение этих логов в структурированном виде в **Neon.tech**, чтобы `LearningBot` в будущем мог их анализировать для оценки качества работы Триа и выявления областей для улучшения.

4.3. Фаза 2: Реализация Логики Ботов, Анализ "Чанков" и Первые Циклы AZR
Второй этап фокусируется на наполнении ботов интеллектуальной логикой, начале практического анализа накопленных "чанков" и запуске первых экспериментальных циклов Absolute Zero Reasoning (AZR).

-   **Развитие Интеллектуальной Логики Ботов:**
    -   `GestureBot`: Интеграция моделей машинного обучения (разработанных или адаптированных) для распознавания и семантической интерпретации жестов. Применение принципов Динамической Семантической Типизации для обогащения понимания жестов.
    -   `AudioBot`: Внедрение продвинутых техник анализа аудио, таких как **CWT на Rust/WASM через AudioWorklet** (как описано в разделе II.5), для извлечения более глубоких характеристик из речи и звуков.
    -   `MemoryBot`: Расширение функционала для управления базой знаний Триа, включая семантический поиск по "чанкам" (метаданные в **Neon.tech**, бинарные данные в **Backblaze B2**) и контекстуальным данным, а также формирование более сложных ассоциативных связей.

-   **Начало Анализа "Чанков" Компонентом `LearningBot`:**
    -   Разработка первых алгоритмов внутри `LearningBot` для автоматического анализа собранных на Фазе 1 "чанков" (данные в **Backblaze B2**, метаданные/контекст в **Neon.tech**).
    -   Цели анализа: выявление паттернов во взаимодействиях, оценка эффективности различных ответов и стратегий Триа, идентификация успешных и неуспешных коммуникативных сценариев.
    -   Результаты анализа должны служить основой для генерации гипотез по улучшению поведения других ботов.

-   **Первые Экспериментальные Циклы Absolute Zero Reasoning (AZR):**
    -   Реализация базовых механизмов AZR в `LearningBot` и его саб-компонентах (`TaskGenerator`, `TaskSolver`, `azr_evaluator`), работающих на основе данных из **Neon.tech** и **Backblaze B2**.
    -   `TaskGenerator` будет формулировать простые задачи или вопросы для Триа, основанные на имеющихся данных, но требующие вывода или решения, не заложенного явно.
    -   `TaskSolver` (представляющий собой кооперацию других ботов под управлением `LearningBot` в рамках **FastAPI приложения на Koyeb**) будет пытаться решить эти задачи.
    -   `azr_evaluator` будет оценивать успешность решений и предоставлять обратную связь для корректировки логики `LearningBot`.
    -   Начальный фокус на простых, контролируемых сценариях для отладки цикла AZR.

-   **Исследование "Жидкого Кода" (Долгосрочная Перспектива):**
    -   Концептуальное исследование и прототипирование (если возможно в рамках текущего стека **FastAPI на Koyeb**) механизмов, вдохновленных "жидким кодом" из `docs/02_RESEARCH/WHITEGHOST.md`. Это включает изучение способов, которыми `LearningBot` мог бы динамически адаптировать или предлагать изменения в логике других ботов на основе результатов своего анализа и AZR.

4.4. Риски и Меры (Специфичные для Развития Триа)
-   **Качество и Разнообразие "Чанков":** Низкое качество или недостаточное разнообразие собираемых "чанков" (хранящихся в **Backblaze B2** с метаданными в **Neon.tech**) может замедлить обучение Триа.
    *Мера:* Разработка четких гайдлайнов для пользователей (если применимо), внедрение механизмов валидации и фильтрации "чанков", стимулирование разнообразных взаимодействий.
-   **Сложность Реализации "Медленного Обучения" и AZR:** Разработка эффективных алгоритмов для `LearningBot` и AZR (в среде **FastAPI на Koyeb**) является нетривиальной R&D задачей.
    *Мера:* Итеративный подход, начало с простых моделей и сценариев, активное использование результатов исследований в области AI и машинного обучения.
-   **Интеграция и Оркестрация Ботов:** По мере усложнения логики ботов, их эффективная координация (в рамках `CoordinationService` на **FastAPI (Koyeb)**) может стать вызовом.
    *Мера:* Постепенное усложнение `CoordinationService`, исследование и возможное внедрение фреймворков типа `LangChain` или `LangGraph` для управления сложными AI-потоками, если это будет оправдано и совместимо с основной архитектурой **FastAPI на Koyeb**.
-   **Зависимость от Внешних LLM:** Качество и доступность внешних LLM (например, Mistral), используемых **FastAPI приложением на Koyeb**, могут влиять на способности Триа.
    *Мера:* Проектирование системы с возможностью гибкой замены или дополнения LLM, исследование локальных или более специализированных моделей для определенных задач.

V. Принципы Работы с AI
5.1. Общая Роль AI в Проекте
... генерации кода (Python для **FastAPI на Koyeb**, JavaScript для фронтенда)... для бэкенда – локальная разработка с AI-инструментами и последующий деплой на **Koyeb через GitHub**.

5.6. Критическое Мышление и Оптимизация
...особенно в контексте использования сервисов **Koyeb, Backblaze B2, Neon.tech, Firebase, Cloudflare**.
Приоритеты: ... модульность **FastAPI приложения на Koyeb**...

5.7. Приоритеты для AI (Focus на текущем стеке Koyeb/Backblaze B2/Neon)
1.  **Реализация текущего стека на Koyeb/Backblaze B2/Neon/Firebase/Cloudflare**: Помощь в разработке и отладке кода для фронтенда (Firebase Hosting) и бэкенда (**FastAPI на Python, деплой на Koyeb**).
2.  **Интеграция Сервисов**: Корректное использование Firebase Authentication, **Backblaze B2, Neon.tech PostgreSQL** (через FastAPI на Koyeb), и **Cloudflare**.
5.  **Оптимизация для Koyeb/FastAPI**: Предложения по оптимизации кода FastAPI и Dockerfile (если используется) для эффективного использования ресурсов Koyeb и соблюдения ограничений Hobby Plan.

VI. Используемые Инструменты и Технологии (Обновлено для Koyeb/Backblaze B2/Neon)
6.1. Общая Стратегия Использования Инструментов
Проект "Голографические Медиа" ориентирован на использование **Koyeb для хостинга бэкенда FastAPI, Backblaze B2 для объектного хранения, Neon.tech PostgreSQL для базы данных, Firebase (Hosting, Authentication) для фронтенда и аутентификации, и Cloudflare для DNS, CDN и защиты.**

6.2. Инструменты Разработки
... Docker: Используется для создания консистентных сред разработки и **для сборки и развертывания FastAPI приложения на Koyeb (если выбран такой метод деплоя).**
(Удалено: PythonAnywhere)

6.3. Инструменты Качества Кода и Тестирования
... **Развертывание FastAPI на Koyeb может быть автоматизировано через GitHub Actions (например, при коммите в основную ветку, Koyeb автоматически забирает изменения).**

6.5. Технологии Бэкенда
**FastAPI (Python 3.11+ на Koyeb, Hobby Plan, Frankfurt)**: Основная технология для реализации серверной логики.
... (Удалено: PythonAnywhere).

VII. Полезные Команды (Обновлено для Koyeb/FastAPI)
(Удален подраздел 7.2.1 PythonAnywhere Команды)
**7.2.1. Koyeb Команды (Управление Бэкенд Приложением)**
-   **Развертывание**: Обычно автоматически при `git push` в основную ветку GitHub репозитория, если Koyeb сервис настроен на отслеживание этой ветки. Также возможно ручное развертывание через UI Koyeb или Koyeb CLI.
-   **Koyeb CLI (если используется)**:
    -   `koyeb login`
    -   `koyeb services list`
    -   `koyeb deployments get <deployment_id>`
    -   `koyeb instances logs <instance_id>`
    -   (команды могут отличаться, проверить актуальную документацию Koyeb CLI)
-   **Просмотр логов**: Через UI Koyeb (логи сервиса, логи билда).
-   **Переменные окружения**: Устанавливаются в настройках сервиса на Koyeb.
-   **Docker (если используется для Koyeb)**:
    -   `docker build -t <image_name> .` (локальная сборка)
    -   `docker run -p 8000:8000 <image_name>` (локальный запуск)
    -   `docker push <registry>/<image_name>:<tag>` (если деплой через Docker Registry)

7.5. Тестирование и Диагностика (Общее)
Логи **FastAPI на Koyeb**: Доступны через веб-интерфейс Koyeb.
Тестирование **FastAPI эндпоинтов**: ... к приложению на Koyeb (URL вида `<app-name>-<org-name>.koyeb.app`).
Пример с curl для Koyeb: `curl -X POST -H "Content-Type: application/json" -H "Authorization: Bearer <FIREBASE_ID_TOKEN>" -d '{"message": "Привет"}' https://<app-name>-<org-name>.koyeb.app/api/v1/chat` (путь к вашему эндпоинту).

7.6. Управление Переменными Окружения и Секретами
**Koyeb**: Переменные окружения устанавливаются через настройки сервиса в UI Koyeb. Они доступны в вашем Python коде через `os.environ.get('VAR_NAME')`.
(Удалено: PythonAnywhere).

VIII. Конфиденциальные Данные (Актуализировано для Koyeb/Backblaze B2/Neon)
8.1. Общие Принципы Хранения
-   **Koyeb Environment Variables**: Основной механизм для хранения секретов для FastAPI приложения (API ключи LLM, строка подключения Neon.tech, ключи доступа **Backblaze B2**). Устанавливаются через веб-интерфейс Koyeb.
(Удалено: PythonAnywhere).

8.2. Список Конфиденциальных Данных (Примеры)
-   **Koyeb**: Специфические токены или ключи API для Koyeb, если используются для управления через API.
-   Firebase/Google Cloud: **Ключ сервисного аккаунта Google (GOOGLE_APPLICATION_CREDENTIALS)**: JSON файл ключа, который может потребоваться для `firebase-admin` SDK на **Koyeb**. Этот файл должен быть безопасно добавлен в переменные окружения Koyeb (например, как base64 строка или через секреты Koyeb, если поддерживается).

8.4. Интеграция с Кодом (**FastAPI на Koyeb**)
Доступ к секретам, установленным как переменные окружения на Koyeb:
```python
import os
import firebase_admin # Пример
from firebase_admin import credentials # Пример
import base64 # Для декодирования GOOGLE_APPLICATION_CREDENTIALS из base64, если так хранится
import json # Для парсинга JSON ключа

# Пример доступа к переменной окружения в FastAPI приложении на Koyeb:
b2_access_key_id = os.environ.get('B2_ACCESS_KEY_ID') # Изменено с R2 на B2
b2_secret_access_key = os.environ.get('B2_SECRET_ACCESS_KEY') # Изменено с R2 на B2
neon_db_connection_string = os.environ.get('NEON_DB_CONNECTION_STRING')
mistral_api_key = os.environ.get('MISTRAL_API_KEY')

# Для инициализации firebase-admin, если используется для проверки токенов:
google_creds_base64 = os.environ.get('GOOGLE_APPLICATION_CREDENTIALS_BASE64') 
if google_creds_base64:
    try:
        if not firebase_admin._apps:
            decoded_creds = base64.b64decode(google_creds_base64)
            cred_json = json.loads(decoded_creds)
            cred = credentials.Certificate(cred_json)
            firebase_admin.initialize_app(cred)
    except Exception as e:
        print(f"Error initializing Firebase Admin SDK from Base64: {e}") 
else:
    # Альтернативно, если GOOGLE_APPLICATION_CREDENTIALS указывает на путь к файлу в контейнере Koyeb
    google_creds_path = os.environ.get('GOOGLE_APPLICATION_CREDENTIALS')
    if google_creds_path:
        try:
            if not firebase_admin._apps:
                 cred = credentials.Certificate(google_creds_path)
                 firebase_admin.initialize_app(cred)
        except Exception as e:
            print(f"Error initializing Firebase Admin SDK from path: {e}")
    else:
        print("GOOGLE_APPLICATION_CREDENTIALS or its Base64 version not set for Koyeb.")
```

IX. Обратная Связь и Планы Тестирования (Обновлено для текущего стека)
9.1. Общие Принципы Тестирования... текущий этап фокусируется на достижении стабильной функциональности **на стеке Koyeb, Backblaze B2, Neon.tech, Firebase, и Cloudflare**.

9.2. План Внутреннего Тестирования (Текущий Стек)
Цель: Проверить работоспособность ключевых функций текущего этапа, развернутых на **Koyeb и Firebase Hosting**...
Этап 1: Тестирование Фронтенда на Firebase Hosting (API запросы идут на Koyeb).
Этап 2: Тестирование **FastAPI Бэкенда на Koyeb**
Задачи:
- Проверка FastAPI эндпоинтов на Koyeb...
- Анализ логов **Koyeb** для выявления ошибок и оценки производительности.
Инструменты: Postman/curl (для HTTP-запросов к FastAPI на Koyeb), **веб-интерфейс Koyeb (логи, метрики)**, `psql`.

Этап 3: Интеграционное Тестирование (E2E для текущего этапа)
Задачи:
- Сквозное тестирование всего цикла:
    2. Загрузка медиа-"чанка" (Frontend -> **FastAPI на Koyeb** -> **Backblaze B2**).
Инструменты: ..., **логи Koyeb**, Firebase Console (для Auth, Hosting).

9.4. Автоматизация Тестирования (Постепенное Внедрение)
CI/CD: ... **Автоматизация развертывания на Koyeb (через GitHub Actions триггеря Koyeb или напрямую деплоя Docker образа) и Firebase Hosting.**

9.5. Риски и Меры (в контексте тестирования)
Риск 2: Сложности с отладкой интеграционных проблем **между Firebase Hosting, Koyeb, Backblaze B2 и Neon.tech**.
Риск 3: Ограничения среды **Koyeb Hobby Plan** (засыпание, лимиты ресурсов) могут влиять на тесты производительности или длительные операции.
Мера: Осознание этих ограничений, фокус на функциональном тестировании для текущего этапа. Использование платных планов Koyeb или других платформ для более серьезного тестирования производительности.

X. Долгосрочные Цели и Видение

10.1. Общее Видение Проекта
Мы стремимся создать новую парадигму цифровой коммуникации, преодолевающую языковые и культурные барьеры через интуитивно понятные аудиовизуальные и жестовые интерфейсы. Проект "Голографические Медиа" (holograms.media) нацелен на разработку платформы, где пользователи могут создавать, делиться и взаимодействовать с мультимодальным контентом, воплощенным в виде "голограмм" – динамических аудиовизуальных представлений. Ключевым элементом является "Неоленг" – новый язык коммуникации, основанный на универсальных жестовых и визуальных паттернах, делающий общение доступным и выразительным для всех.
Текущая реализация, построенная на стеке **FastAPI на Koyeb (бэкенд), Backblaze B2 (хранилище файлов), Neon.tech PostgreSQL (база данных), Firebase Hosting и Authentication (фронтенд и аутентификация), и Cloudflare (DNS, CDN, защита)**, является первым, но важным шагом к достижению этого амбициозного видения.

10.2. Долгосрочные Цели (Начиная с Post-MVP ~Q3-Q4 2024 г.)

*   **Полная Иммерсивность и Интеграция WebXR (Активная фаза с конца 2024 г. - начало 2025 г.):**
    *   **Цель:** Обеспечить полноценный опыт взаимодействия с голограммами в средах WebXR (AR/VR) на различных устройствах.
    *   **Задачи:**
        *   Глубокая интеграция с WebXR API, оптимизация рендеринга (включая WebGPU R&D) для высокой производительности.
        *   Разработка интуитивных жестовых интерфейсов управления в 3D-пространстве.
        *   Создание SDK и инструментов для разработчиков для упрощения создания WebXR-контента на платформе.

*   **AI "Триа" – Самообучение, Автономность и Эволюция (Постоянно, активная фаза R&D с 2025 г.):**
    *   **Цель:** Превратить "Триа" в полностью самообучающуюся и автономную AI-систему, способную к "самосборке" и адаптации своей логики.
    *   **Задачи:**
        *   Развитие механизмов "медленного обучения" на основе собираемых "чанков" (данные в **Backblaze B2**, метаданные в **Neon.tech PostgreSQL**).
        *   Полноценная реализация концепции Absolute Zero Reasoning (AZR) для генерации новых знаний и навыков.
        *   Переход на Genkit (или аналогичный фреймворк) для продвинутой оркестрации AI-логики, интегрированный с основным бэкендом на **FastAPI (Koyeb)**.
        *   Исследование и внедрение принципов "жидкого кода" для динамической адаптации Триа.

*   **Децентрализованная Экономическая Экосистема "HoloGraph" (R&D и поэтапное внедрение с 2025 г.+):**
    *   **Цель:** Создать самофинансируемую и самоуправляемую экономическую модель для поддержки развития платформы и вознаграждения участников.
    *   **Задачи:**
        *   Разработка токеномики "HoloGraph" и механизмов стимулирования ("жестовый/интеллектуальный майнинг" – создание и аннотирование ценных "чанков").
        *   Исследование и внедрение элементов DAO (Decentralized Autonomous Organization) для управления платформой.
        *   Интеграция смарт-контрактов для управления правами на контент, транзакциями и вознаграждениями.

*   **"Неоленг" – Новый Язык Коммуникации (Активное развитие с 2025 г.+):**
    *   **Цель:** Развить "Неоленг" в универсальный и интуитивно понятный язык, основанный на жестах, 3D-эмодзи и аудиовизуальных паттернах.
    *   **Задачи:**
        *   Создание и расширение библиотеки универсальных жестовых и визуальных паттернов "Неоленга".
        *   Интеграция `GestureBot` (часть **FastAPI на Koyeb**) с распознаванием и генерацией элементов "Неоленга".
        *   Публикация Whitepaper "Неоленга" и привлечение лингвистов и исследователей.

10.3. Сообщество и Open Source (Постоянно)
*   **Цель:** Построить активное и вовлеченное сообщество разработчиков, контент-мейкеров и пользователей вокруг платформы.
*   **Задачи:**
    *   Развитие и поддержка подробной документации для разработчиков, включая API для **FastAPI на Koyeb** и SDK.
    *   Проведение хакатонов, конкурсов и образовательных инициатив.
    *   Активное взаимодействие с сообществом через форумы, социальные сети и GitHub.
    *   Поддержание и развитие проекта на принципах Open Source (лицензия MIT).

10.4. Применение и Воздействие (Постоянно)
*   **Цель:** Применить технологию "Голографические Медиа" для решения реальных проблем и создания положительного социального воздействия.
*   **Области применения:**
    *   **Образование и доступность:** Инструменты для обучения людей с нарушениями слуха, создание иммерсивных образовательных материалов.
    *   **Искусство и творчество:** Новые формы цифрового искусства, интерактивные инсталляции.
    *   **Коммуникация:** Преодоление языковых барьеров с помощью "Неоленга", создание более выразительных форм общения.
    *   **Терапия и реабилитация:** Инструменты для удаленной терапии и социальной адаптации.

10.5. Стратегические Риски и Меры (Долгосрочные)
*   **Технологическая сложность:** Разработка передовых AI и XR технологий требует значительных усилий и может столкнуться с непредвиденными трудностями.
    *   *Мера:* Гибкая архитектура (например, использование Genkit с **FastAPI на Koyeb** для AI), модульный подход, R&D итерации, привлечение экспертов.
*   **Формирование активного сообщества:** Привлечение и удержание пользователей и разработчиков – нетривиальная задача.
    *   *Мера:* Прозрачность разработки, качественные инструменты для разработчиков, интересные задачи и конкурсы, активный маркетинг и PR.
*   **Финансирование R&D и HoloGraph:** Долгосрочные исследования и разработка децентрализованной экономики требуют ресурсов.
    *   *Мера:* Поиск грантов, партнерство с фондами, поэтапное внедрение HoloGraph с фокусом на создание ценности для ранних пользователей.
*   **Эволюция облачных платформ:** Зависимость от сторонних сервисов (**Koyeb, Neon.tech, Backblaze B2, Firebase, Cloudflare**) несет риски изменения их политики или доступности.
    *   *Мера:* Использование стандартных интерфейсов и протоколов (S3 API для **Backblaze B2**, стандартный SQL для **Neon.tech PostgreSQL**), мониторинг рынка облачных услуг, разработка стратегии миграции при необходимости.
*   **Этические аспекты AI и цифровой идентичности:** Создание реалистичных аватаров и самообучающегося AI поднимает этические вопросы.
    *   *Мера:* Разработка этических гайдлайнов, обеспечение прозрачности работы AI, механизмы контроля для пользователей.
```
